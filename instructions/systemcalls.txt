### **–û—Ç–ª–∏—á–∏–µ int 0x80 –æ—Ç syscall –≤ x86/x86-64**

–≠—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π —è–¥—Ä–∞ (—Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤), –Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É:

---

## **üîπ 1. int 0x80 (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–ø–æ—Å–æ–±–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?–æ—Ç–∞–µ—Ç?*–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ—ã–≤–∞–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —è–¥—Ä—É —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π (IDT).
- –í Linux —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å 32-–±–∏—Ç–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –¥–∞–∂–µ –Ω–∞ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏–Ω–Ω–æ—Å—Ç–∏**
| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
|----------------------|---------------------------------------------------------------------–°–∫–æ—Ä–æ—Å—Ç—å–æ—Ä–æ—Å—Ç—å**         | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (–ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π)                    –ê—Ä–≥—É–º–µ–Ω—Ç—ã—É–º–µ–Ω—Ç—ã**        | –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã: eax (–Ω–æ–º–µ—Ä –≤—ã–∑–æ–≤–∞), ebx, ecx, edx–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–∏—á–µ–Ω–∏—è**      | –í 64-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 64-–±–∏—Ç–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏!             –ü–æ–¥–¥–µ—Ä–∂–∫–∞–¥–µ—Ä–∂–∫–∞**        | –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –Ω–∞ —Å—Ç–∞—Ä—ã—Ö CPU (–Ω–∞—á–∏–Ω–∞—è —Å 80386)                      –ü—Ä–∏–º–µ—Ä (32-bit):-bit):**
mov eax, 1   ; sys_exit
mov ebx, 42  ; —Å—Ç–∞—Ç—É—Å
int 0x80
---

## **üîπ 2. syscall (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç? —Ä–∞–±–æ—Ç–∞—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –≤ AMD64 (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π).
-MSR-—Ä–µ–≥–∏—Å—Ç—Ä—ãR-—Ä–µ–≥–∏—Å—Ç—Ä—ã** –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–±—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**
| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
|----------------------|-----------------------------------------------------------------–°–∫–æ—Ä–æ—Å—Ç—å**–°–∫–æ—Ä–æ—Å—Ç—å**         | –ë—ã—Å—Ç—Ä–µ–µ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å)                                 –ê—Ä–≥—É–º–µ–Ω—Ç—ã*–ê—Ä–≥—É–º–µ–Ω—Ç—ã**        | –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑: rax (–Ω–æ–º–µ—Ä), rdi, rsi, rdx, r10, r8, r9 |
| **64-–±–∏—Ç–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** | –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 64-–±–∏—Ç–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏                  –ü–æ–¥–¥–µ—Ä–∂–∫–∞
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**        | –¢–æ–ª—å–∫–æ –Ω–∞ x86-64 CPU (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 32-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ)      –ü—Ä–∏–º–µ—Ä (64-bit):–∏–º–µ—Ä (64-bit):**
mov rax, 60  ; sys_exit
mov rdi, 42  ; —Å—Ç–∞—Ç—É—Å
syscall
---

## **üîπ 3. –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è**
| –ü–∞—Ä–∞–º–µ—Ç—Ä          | int 0x80                          | syscall                          |
|-------------------|-------------------------------------|--------------------–¢–∏–ø---------|
| **–¢–∏–ø**          | –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ                          | –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫–†–µ–≥–∏—Å—Ç—Ä—ã    |
| **–†–µ–≥–∏—Å—Ç—Ä—ã**     | eax, ebx, ecx, edx...       | rax, rdi, rsi, rdx, r10... |
| **–°–∫–æ—Ä–æ—Å—Ç—å**     | ~50-100 —Ç–∞–∫—Ç–æ–≤                      | ~20-30 —Ç–∞–∫—Ç–æ–≤  64-–±–∏—Ç–Ω–æ—Å—Ç—å     |
| **64-–±–∏—Ç–Ω–æ—Å—Ç—å**  | –û–±—Ä–µ–∑–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª–∏ (>32 –±–∏—Ç)        | –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å    |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | –£—è–∑–≤–∏–º –∫ Spectre/Meltdown           | –ó–∞—â–∏—â—ë–Ω–Ω—ã–π –ø—É—Ç—å–ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç    |
| **–ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** | 32/64-bit (–Ω–æ –≤ 64-bit ‚Äî deprecated)| –¢–æ–ª—å–∫–æ 64-bit         üîπ 4. –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ü—Ä–∏–º–í—ã–∑–æ–≤ write (–≤—ã–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏)–≤ write (–≤—ã–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏)**
#### **–ß–µ—Ä–µ–∑ int 0x80 (32-bit)**
mov eax, 4       ; sys_write
mov ebx, 1       ; stdout
mov ecx, msg     ; –∞–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏
mov edx, len     ; –¥–ª–∏–Ω–∞
int 0x80
#### **–ß–µ—Ä–µ–∑ syscall (64-bit)**
mov rax, 1       ; sys_write
mov rdi, 1       ; stdout
mov rsi, msg     ; –∞–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏
mov rdx, len     ; –¥–ª–∏–Ω–∞
syscall
--–î–ª—è 32-–±–∏—Ç–Ω–æ–≥–æ –∫–æ–¥–∞—å–∑–æ–≤–∞—Ç—å?**
- **–î–ª—è 32-–±–∏—Ç–Ω–æ–≥–æ –∫–æ–¥–∞**: int 0x80 (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç).  
- **–î–ª—è 64-–±–∏—Ç–Ω–æ–≥–æ –∫–æ–¥–∞**: –≤—Å–µ–≥–¥–∞ syscall (–±—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ).  
- **–î–ª—è –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞**: –∏—Å–ø–æ–ª–í–∞–∂–Ω–æ!—Ä—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ libc).  

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ!** –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö Linux int 0x80 –≤ 64-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ –º–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å 64-–±–∏—Ç–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∞–¥—Ä–µ—Å > 0xFFFFFFFFsyscall vs sysenter–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω—é–∞–Ω—Å—ã**
### **syscall vs sysenter**
- sysenter ‚Äî –∞–Ω–∞–ª–æ–≥ syscall –¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (Intel), –Ω–æ —Å–ª–æ–∂–Ω–µ–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.  
- syscall ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è x86-64.  

### **–ö–∞–∫ —è–¥—Ä–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–∑–æ–≤—ã?**
- –î–ª—è int 0x80:  
  –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ IDT ‚Üí entry_INT80_32 (—Å–º. –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ —è–¥—Ä–∞ Linux).  
- –î–ª—è syscall:  
  –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ MSR_LSTAR (—Ä–µ–≥–∏—Å—Ç—Ä 0xC0000082).  

---
